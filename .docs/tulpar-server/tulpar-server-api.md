# API

Это документация API для Tulpar Server.

## Версия API которая планируется создать (нужно выбрать вариант)

### Вариант от GoldenVadim

**Для оптимизации работы данного API я бы хотел обновить APG, но это потом.**

#### Просмотр любого файла в пакете
```
https://repo.nuros.org/package/example?arch=x86_64?path=metadata.json
```

#### Скачивание пакета
```
https://repo.nuros.org/package/example?arch=x86_64
```

### Второй вариант от GoldenVadim

**Для использования второго варианта необходимо обновить APG.**  
В этом варианте отсутствует просмотр любого файла внутри пакета.

#### Получение информации об пакете
```
https://repo.nuros.org/info?name=example
```

#### Скачивание пакета
```
https://repo.nuros.org/package/example?arch=x86_64
```

## Версия API v1.0

Эта версия является старой, но рабочей.

### Скачивание пакета

```
https://server.com/package/example
```

### Просмотр любого файла в пакете (кроме папок)

```
https://server.com/package/example/manifest.json
```

## Версия API v2.0

Эта версия доступна начиная с tulpar-server 1.2.

### Скачивание пакета

```
https://server.com/api/v2.0/get?package=example
```

### Просмотр любого файла в пакете

```
https://server.com/api/v2.0/get?package=example&path=metadata.json
```

### Просмотр любого файла в папке

Теперь добавлена поддержка папок, используйте относительный путь.

```
https://server.com/api/v2.0/get?package=example&path=/scripts/postinstall
```

### Получение системной переменной

```
https://server.com/api/v2.0/info?property=os.name
```

### Дополнительные возможности в версии API v2.0

#### Получение списка всех пакетов

```
https://server.com/api/v2.0/list
```

#### Скачивание файлов в потоке

Теперь файлы скачиваются в потоке, что минимизирует потребление ОЗУ на сервере.

#### 404-страница

Добавлена страница ошибки 404:

```
/errors/404.html
```

#### Серверная иконка

Добавлена поддержка серверной иконки (пока что не стабильно работает):

```
/icons/server-icon.png
```

## Бета-версия tulpar-server v2.0-beta.1

Вышла бета-версия tulpar-server. В этой версии были отключены логи и конфигурация, так как это бета-релиз. Порт для запуска берётся из файла `port_for_test_server.txt`.

### Нововведения:

* `/api/v2.0/list` - отдает JSON-содержимое списка пакетов.
* Теперь скачивание файла является потоковым, благодаря этому потребление ОЗУ минимальное.
* Добавлена 404 страница в `/errors/404.html`.
* Серверная иконка устанавливается в `/icons/server-icon.png`.

[Подробнее о релизе](https://github.com/NurOS-Linux/tulpar-server/releases/tag/v2.0-beta.1)

```▋
```
